mtext("Collection Location", side = 2, line = -1, cex = 1.5)
mtext("Predicted Population", side = 3, cex = 1.5, at = 6, line = 1)
par(mar = c(0,0,5,0), oma = c(0,0,5,0))
corrplot(hyb_cm, is.corr = F, method = 'color', addCoef.col = 'darkorange2',
tl.srt = 0, tl.offset = 1.5, number.digits = 2, tl.cex = .75,
tl.col = 'black', cl.pos = 'n', na.label = 'square',
na.label.col = 'white', addgrid.col = 'grey')
mtext("Collection Location", side = 2, line = -1, cex = 1.5)
mtext("Predicted Population", side = 3, cex = 1.5, at = 6, line = 1)
par(mar = c(0,0,0,0), oma = c(0,0,3,0))
corrplot(hyb_cm, is.corr = F, method = 'color', addCoef.col = 'darkorange2',
tl.srt = 0, tl.offset = 1.5, number.digits = 2, tl.cex = .75,
tl.col = 'black', cl.pos = 'n', na.label = 'square',
na.label.col = 'white', addgrid.col = 'grey')
mtext("Collection Location", side = 2, line = -1, cex = 1.5)
mtext("Predicted Population", side = 3, cex = 1.5, at = 3, line = 1)
par(mar = c(0,0,0,0), oma = c(0,0,3,0))
corrplot(hyb_cm, is.corr = F, method = 'color', addCoef.col = 'darkorange2',
tl.srt = 0, tl.offset = 1.5, number.digits = 2, tl.cex = .75,
tl.col = 'black', cl.pos = 'n', na.label = 'square',
na.label.col = 'white', addgrid.col = 'grey')
mtext("Collection Location", side = 2, line = -1, cex = 1.5)
mtext("Predicted Population", side = 3, cex = 1.5, at = 2, line = 1)
par(mar = c(0,0,0,0), oma = c(0,0,3,0))
corrplot(hyb_cm, is.corr = F, method = 'color', addCoef.col = 'darkorange2',
tl.srt = 0, tl.offset = 1.5, number.digits = 2, tl.cex = .75,
tl.col = 'black', cl.pos = 'n', na.label = 'square',
na.label.col = 'white', addgrid.col = 'grey')
mtext("Collection Location", side = 2, line = -10, cex = 1.5)
mtext("Predicted Population", side = 3, cex = 1.5, at = 2, line = 1)
par(mar = c(0,0,0,0), oma = c(0,0,3,0))
corrplot(hyb_cm, is.corr = F, method = 'color', addCoef.col = 'darkorange2',
tl.srt = 0, tl.offset = 1.5, number.digits = 2, tl.cex = 1,
tl.col = 'black', cl.pos = 'n', na.label = 'square',
na.label.col = 'white', addgrid.col = 'grey')
mtext("Collection Location", side = 2, line = -10, cex = 1.5)
mtext("Predicted Population", side = 3, cex = 1.5, at = 2, line = 1)
#data
hyb = read.csv("Figures/hybrid_cms/hybrid_pop_predictions_all.csv", stringsAsFactors = F)
boxplot(hyb$pred_hyb ~ hyb$DA)
boxplot(hyb$DA ~ hyb$pred_hyb)
par(mar = c(0,0,0,0), oma = c(0,0,0,0))
boxplot(hyb$DA ~ hyb$pred_hyb)
par(mar = c(0,0,0,0), oma = c(0,0,0,0))
boxplot(DA~pred_hyb, data = hyb, ylab = 'Proportion of D. alaskensis ancestry',
xlab = 'Predicted population')
#Plot ancestry vs hybrid population prediction
setwd("C:/Users/istas/OneDrive/Documents/Dryas Research/Dryas 2.0")
################################################################################
# Fit PLS_DA model all dry
################################################################################
#data
hyb = read.csv("Figures/hybrid_cms/hybrid_pop_predictions_all.csv", stringsAsFactors = F)
par(mar = c(0,0,0,0), oma = c(0,0,0,0))
boxplot(DA~pred_hyb, data = hyb, ylab = 'Proportion of D. alaskensis ancestry',
xlab = 'Predicted population')
dev.off()
#data
hyb = read.csv("Figures/hybrid_cms/hybrid_pop_predictions_all.csv", stringsAsFactors = F)
par(mar = c(0,0,0,0), oma = c(0,0,0,0))
boxplot(DA~pred_hyb, data = hyb, ylab = 'Proportion of D. alaskensis ancestry',
xlab = 'Predicted population')
View(hyb)
par(mar = c(0,0,0,0), oma = c(0,0,0,0))
boxplot(DA~pred_hyb, data = hyb, ylab = 'Proportion of D. alaskensis ancestry',
xlab = 'Predicted population', xlim = c(.4,.7))
hyb = read.csv("Figures/hybrid_cms/hybrid_pop_predictions_all.csv", stringsAsFactors = F)
par(mar = c(0,0,0,0), oma = c(0,0,0,0))
boxplot(DA~pred_hyb, data = hyb, ylab = 'Proportion of D. alaskensis ancestry',
xlab = 'Predicted population', ylim = c(.4,.7))
par(mar = c(0,0,0,0), oma = c(0,0,0,0))
boxplot(DA~pred_hyb, data = hyb, ylab = 'Proportion of D. alaskensis ancestry',
xlab = 'Predicted population', ylim = c(.3,.7))
par(mar = c(4,4,4,4))
boxplot(DA~pred_hyb, data = hyb, ylab = 'Proportion of D. alaskensis ancestry',
xlab = 'Predicted population', ylim = c(.3,.7), )
par(mar = c(4,4,4,4))
boxplot(DA~pred_hyb, data = hyb, ylab = 'Proportion of D. alaskensis ancestry',
xlab = 'Predicted population', ylim = c(.3,.7))
par(mar = c(5,5,4,4))
boxplot(DA~pred_hyb, data = hyb, ylab = 'Proportion of D. alaskensis ancestry',
xlab = 'Predicted population', ylim = c(.3,.7))
par(mar = c(5,5,4,4))
boxplot(DA~pred_hyb, data = hyb, ylab = 'Proportion of D. alaskensis ancestry',
xlab = 'Predicted population', ylim = c(.3,.7))
abline(h = 0, lty = 2, lwd = 1)
par(mar = c(5,5,4,4))
boxplot(DA~pred_hyb, data = hyb, ylab = 'Proportion of D. alaskensis ancestry',
xlab = 'Predicted population', ylim = c(.3,.7))
abline(h = 0.5, lty = 2, lwd = 1)
par(mar = c(5,5,4,4))
boxplot(DA~pred_hyb, data = hyb, ylab = 'Proportion of D. alaskensis ancestry',
xlab = 'Predicted population', ylim = c(.3,.7), notch = T)
abline(h = 0.5, lty = 2, lwd = 1)
par(mar = c(5,5,4,4))
boxplot(DA~pred_hyb, data = hyb, ylab = 'Proportion of D. alaskensis ancestry',
xlab = 'Predicted population', ylim = c(.3,.7), notch = F)
abline(h = 0.5, lty = 2, lwd = 1)
#data
spec_all = readRDS("Clean-up/Clean_spectra/clean_all.rds")
oct = spec_all[meta(spec_all)$Species_ID == "DO"]
library(spectrolab)
ala = spec_all[meta(spec_all)$Species_ID == "DA"]
oct
oct = spec_all[meta(spec_all)$Species_ID == "DO"]
ala = spec_all[meta(spec_all)$Species_ID == "DA"]
#####################################################
oct
460/4
ala
208/4
hby = spec_all[meta(spec_all)$Species_ID == "DX"]
hby
32/4
setwd("C:/Users/istas/OneDrive/Documents/Dryas Research/Dryas 2.0")
################################################################################
# Fit PLS_DA model all dry
################################################################################
#data
hyb = read.csv("Figures/hybrid_cms/hybrid_pop_predictions_all.csv", stringsAsFactors = F)
par(mar = c(5,5,4,4))
boxplot(DA~Location, data = hyb, ylab = 'Proportion of D. alaskensis ancestry',
xlab = 'Location', ylim = c(.3,.7), notch = F)
abline(h = 0.5, lty = 2, lwd = 1)
par(mar = c(5,5,4,4))
boxplot(DA~Location, data = hyb, ylab = 'Proportion of D. alaskensis ancestry',
xlab = 'Location', ylim = c(.3,.7), notch = F,
main = 'D. alaskensis ancestry versus location')
abline(h = 0.5, lty = 2, lwd = 1)
View(hyb)
par(mar = c(5,5,4,4))
boxplot(DA~pred_hyb, data = hyb, ylab = 'Proportion of D. alaskensis ancestry',
xlab = 'Location', ylim = c(.3,.7), notch = F,
main = 'D. alaskensis ancestry versus predicted population')
abline(h = 0.5, lty = 2, lwd = 1)
par(mar = c(5,5,4,4))
boxplot(DA~pred_hyb, data = hyb, ylab = 'Proportion of D. alaskensis ancestry',
xlab = 'Predicted Population', ylim = c(.3,.7), notch = F,
main = 'D. alaskensis ancestry of hybrids versus predicted population')
abline(h = 0.5, lty = 2, lwd = 1)
par(mar = c(5,5,4,4))
boxplot(DA~Location, data = hyb, ylab = 'Proportion of D. alaskensis ancestry',
xlab = 'Location', ylim = c(.3,.7), notch = F,
main = 'D. alaskensis ancestry of hybrids versus location')
abline(h = 0.5, lty = 2, lwd = 1)
library(tidyverse)
library(caret)
library(pls)
library(spectrolab)
setwd("C:/Users/istas/OneDrive/Documents/Dryas Research/Dryas 2.0")
spectra = readRDS("Clean-up/Clean_spectra/clean_all.rds")
spectra = spectra[!meta(spectra)$DA == "NaN",]
es = spectra[meta(spectra)$Location == "Eagle Summit",]
tm = spectra[meta(spectra)$Location == "Twelve Mile",]
wdb = spectra[meta(spectra)$Location == "Wickersham Dome B",]
spectra = Reduce(spectrolab::combine, list(es, tm, wdb))
spectra.df = as.data.frame(spectra)
spectra.m = as.matrix(spectra)
spec_df = as.data.frame(spectra.m)
spec_df = cbind(spec_df, spectra.df$DA)
spec_df = cbind(spec_df, spectra.df$Location)
colnames(spec_df)[colnames(spec_df) == "spectra.df$DA"] <- "DA"
spec_df2 = cbind(spec_df, spectra.df$Species_ID)
colnames(spec_df2)[colnames(spec_df2) == "spectra.df$Species_ID"] <- "Species_ID"
set.seed(12)
training.samples <-
createDataPartition(spec_df$DA, p = 0.8, list = FALSE)
train.data  <- spec_df[training.samples, ]
test.data <- spec_df[-training.samples, ]
train.plot <-spec_df2[training.samples, ]
test.plot <- spec_df2[-training.samples, ]
test.plot$color = "black"
test.plot$color[test.plot$Species_ID == "DO"]="red"
test.plot$color[test.plot$Species_ID == "DA"]="blue"
train.data$DA
ala = test.plot$Species_ID == 'DA'
ala = subset(test.plot$Species_ID == 'DA')
?subset
ala = subset(test.plot, Species_ID == 'DA')
ala$DA
spec_df2 = cbind(spec_df2, spectra.df$Name)
colnames(spec_df2)[colnames(spec_df2) == "spectra.df$Name"] <- 'Name'
train.plot <-spec_df2[training.samples, ]
test.plot <- spec_df2[-training.samples, ]
test.plot$color = "black"
test.plot$color[test.plot$Species_ID == "DO"]="red"
test.plot$color[test.plot$Species_ID == "DA"]="blue"
ala = subset(test.plot, Species_ID == 'DA')
ala$DA
ala38 = ala$DA[38]
ala38 = ala[38,]
View(ala38)
setwd("C:/Users/istas/OneDrive/Documents/Dryas Research/Dryas 2.0")
spec_all = readRDS("Clean-up/Clean_spectra/clean_all.rds")
es = spec_all[meta(spec_all)$Location == "Eagle Summit"]
es_ala = es[meta(es)$Species_ID == "DA"]
es_oct = es[meta(es)$Species_ID == "DO"]
es_hyb = es[meta(es)$Species_ID == "DX"]
tm = spec_all[meta(spec_all)$Location == "Twelve Mile"]
tm_ala = tm[meta(tm)$Species_ID == "DA"]
tm_oct = tm[meta(tm)$Species_ID == "DO"]
tm_hyb = tm[meta(tm)$Species_ID == "DX"]
wdb = spec_all[meta(spec_all)$Location == "Wickersham Dome B"]
wdb_ala = wdb[meta(wdb)$Species_ID == "DA"]
wdb_oct = wdb[meta(wdb)$Species_ID == "DO"]
wdb_hyb = wdb[meta(wdb)$Species_ID == "DX"]
library(spectrolab)
spec_all = readRDS("Clean-up/Clean_spectra/clean_all.rds")
es = spec_all[meta(spec_all)$Location == "Eagle Summit"]
es_ala = es[meta(es)$Species_ID == "DA"]
es_oct = es[meta(es)$Species_ID == "DO"]
es_hyb = es[meta(es)$Species_ID == "DX"]
tm = spec_all[meta(spec_all)$Location == "Twelve Mile"]
tm_ala = tm[meta(tm)$Species_ID == "DA"]
tm_oct = tm[meta(tm)$Species_ID == "DO"]
tm_hyb = tm[meta(tm)$Species_ID == "DX"]
wdb = spec_all[meta(spec_all)$Location == "Wickersham Dome B"]
wdb_ala = wdb[meta(wdb)$Species_ID == "DA"]
wdb_oct = wdb[meta(wdb)$Species_ID == "DO"]
wdb_hyb = wdb[meta(wdb)$Species_ID == "DX"]
View(es_ala)
es_ala
76/4
es_oct
84/4
es_hyb
tm_ala
tm_oct
tm_hyb
wdb_oct
56/4
wdb_ala
wdb_hyb
bg = spec_all[meta(spec_all)$Location == "Bison Gulch"]
bg
md = spec_all[meta(spec_all)$Location == "Murphy Dome B"]
md
wda = spec_all[meta(spec_all)$Location == "Wickersham Dome A"]
wda
21+20+14+20+20+20
115*4
19+21+11
51*4
library(spectrolab)
library(caret)
library(mlbench)
library(corrplot)
library(matrixStats)
library(naniar)
?createDataPartition
?trainControl
library(spectrolab)
library(caret)
library(mlbench)
library(corrplot)
library(matrixStats)
library(naniar)
setwd("C:/Users/istas/OneDrive/Documents/Dryas Research/Dryas 2.0")
#data
spec_all = readRDS("Clean-up/Clean_spectra/clean_all.rds")
spec_all = spec_all[!meta(spec_all)$Species_ID == "NaN",]
spec_all.m = as.matrix(spec_all)
spec_all.df = as.data.frame(spec_all)
#Resample by every 10 nm
spec_small = resample(spec_all, seq(400, 2400, by = 10))
spec_mat_s = as.matrix(spec_small)
spec_mat = spec_mat_s
#combine relavant meta data to matrix
spec_df = as.data.frame(spec_mat)
spec_df = cbind(spec_df, spec_all.df$Species_ID)
colnames(spec_df)[colnames(spec_df) == "spec_all.df$Species_ID"] <- "Species_ID"
#Partition Data
for(i in 1:10){
set.seed(i)
inTrain <- caret::createDataPartition(
y = spec_df$Species_ID,
p = .8,
list = FALSE
)
training <- spec_df[inTrain,]
testing <- spec_df[-inTrain,]
#tune model
ctrl <- trainControl(
method = "repeatedcv",
number = 10,
repeats = 3)
plsFit <- train(
Species_ID ~ .,
data = training,
method = "pls",
preProc = c("center", "scale"),
trControl = ctrl,
tuneLength = 100)
assign(paste0('plsFit', i), plsFit)
loadings = plsFit$finalModel$loadings
loadings.m = as.matrix(loadings)
class(loadings.m) <- 'matrix'
assign(paste0('lm',i), loadings.m)
comp1 = loadings.m[,1]
assign(paste0('comp1_',i), comp1)
comp2 = loadings.m[,2]
assign(paste0('comp2_',i), comp2)
comp3 = loadings.m[,3]
assign(paste0('comp3_',i), comp3)
#test model
plsClasses <- predict(plsFit, newdata = testing)
#Confusion matrices
cm = confusionMatrix(data = plsClasses, testing$Species_ID)
cm.m = as.matrix(cm)
assign(paste0("cm", i), cm.m)
}
warnings()
?train
plsFit$finalModel$tuneValue
plsFit$finalModel$bestIter
plsFit$results
plsFit$results$Accuracy
k = plsFit$results$Kappa
k
k.m = as.matrix(k)
View(k.m)
k1 = as.matrix(plsFit1$results$Kappa)
k2 = as.matrix(plsFit2$results$Kappa)
k3 = k1 + k2
View(k3)
View(k3)
k3 = cbind(k1,k2)
View(k3)
k1 = as.matrix(plsFit1$results$Kappa)
k2 = as.matrix(plsFit2$results$Kappa)
k3 = as.matrix(plsFit3$results$Kappa)
k4 = as.matrix(plsFit4$results$Kappa)
k5 = as.matrix(plsFit5$results$Kappa)
k6 = as.matrix(plsFit6$results$Kappa)
k7 = as.matrix(plsFit7$results$Kappa)
k8 = as.matrix(plsFit8$results$Kappa)
k9 = as.matrix(plsFit9$results$Kappa)
k10 = as.matrix(plsFit10$results$Kappa)
k.total = Reduce(cbind, list(k1,k2,k3,k4,k5,k6,k7,k8,k9,k10))
View(k.total)
kavg = rowMeans(k.total)
plot(kavg)
?rowSds
ksd = rowSds(k.total)
kavg = as.matrix(rowMeans(k.total))
ksd = as.matrix(rowSds(k.total))
klower = kavg - ksd
khigher = kavg + ksd
plot(kavg, type = 'l', lty = 1)
plot(klower, type = 'l', lty = 2, add = T)
plot(khigher, type = 'l', lty = 2, add = T)
plot(kavg, type = 'l', lty = 1)
lines(klower, lty = 2)
lines(khigher, lty = 2)
warnings()
plot(kavg, type = 'l', lty = 1, ylab = 'Kappa', xlab = 'Component')
lines(klower, lty = 2, col = 'red')
lines(khigher, lty = 2, col = 'red')
plot(kavg, type = 'p', ylab = 'Kappa', xlab = 'Component')
lines(klower, lty = 2, col = 'red')
lines(khigher, lty = 2, col = 'red')
plot(kavg, type = 'p', pch = 16, ylab = 'Kappa', xlab = 'Component')
lines(klower, lty = 2, col = 'red')
lines(khigher, lty = 2, col = 'red')
plot(kavg, type = 'p', pch = 16, ylab = 'Kappa', ylim = c(0:1, .1), xlab = 'Component')
lines(klower, lty = 2, col = 'red')
lines(khigher, lty = 2, col = 'red')
plot(kavg, type = 'p', pch = 16, ylab = 'Kappa', ylim = seq(0,1, by = 0.1), xlab = 'Component')
lines(klower, lty = 2, col = 'red')
lines(khigher, lty = 2, col = 'red')
s = seq(0,1, by =.1)
plot(kavg, type = 'p', pch = 16, ylab = 'Kappa', ylim = s, xlab = 'Component')
lines(klower, lty = 2, col = 'red')
lines(khigher, lty = 2, col = 'red')
plot(kavg, type = 'p', pch = 16, ylab = 'Kappa', ylim = c(0:1), xlab = 'Component')
lines(klower, lty = 2, col = 'red')
lines(khigher, lty = 2, col = 'red')
plot(kavg, type = 'p', pch = 16, ylab = 'Kappa', ylim = c(0:1), at = s, xlab = 'Component')
lines(klower, lty = 2, col = 'red')
lines(khigher, lty = 2, col = 'red')
plot(kavg, type = 'p', pch = 16, ylab = 'Kappa', xlab = 'Component')
lines(klower, lty = 2, col = 'red')
lines(khigher, lty = 2, col = 'red')
plot(kavg, type = 'p', pch = 16, ylab = 'Kappa', xlab = 'Component', xlim = (0:60))
lines(klower, lty = 2, col = 'red')
lines(khigher, lty = 2, col = 'red')
plot(kavg, type = 'p', pch = 16, ylab = 'Kappa', xlab = 'Component', xlim = (0,60))
lines(klower, lty = 2, col = 'red')
lines(khigher, lty = 2, col = 'red')
plot(kavg, type = 'p', pch = 16, ylab = 'Kappa', xlab = 'Component', xlim = c(0:60))
lines(klower, lty = 2, col = 'red')
lines(khigher, lty = 2, col = 'red')
plot(kavg, type = 'p', pch = 16, ylab = 'Kappa', xlab = 'Component', xlim = c(0,60))
lines(klower, lty = 2, col = 'red')
lines(khigher, lty = 2, col = 'red')
plot(kavg, type = 'p', pch = 16, ylab = 'Kappa', xlab = 'Component', xlim = c(0,40))
lines(klower, lty = 2, col = 'red')
lines(khigher, lty = 2, col = 'red')
?axis
plot(kavg, type = 'p', axes = F)
axis(side = 1, at = seq(0,60, by = 5), labels = c(0:60))
mtext('Component', side = 1, line = 0)
axis(side = 2, at = seq(0, 1, by = .1), labels = c(0:1))
mtext('Kappa', side = 2, line = 0)
lines(klower, lty = 2, col = 'red')
lines(khigher, lty = 2, col = 'red')
plot(kavg, type = 'p', xaxt = 'n', yaxt = 'n')
axis(side = 1, at = seq(0,60, by = 5), labels = c(0:60))
mtext('Component', side = 1, line = 0)
axis(side = 2, at = seq(0, 1, by = .1), labels = c(0:1))
mtext('Kappa', side = 2, line = 0)
lines(klower, lty = 2, col = 'red')
lines(khigher, lty = 2, col = 'red')
plot(kavg, type = 'p', xaxt = 'n', yaxt = 'n')
axis(side = 1, at = seq(0,60, by = 5), labels = seq(0,60, by = 5))
mtext('Component', side = 1, line = 0)
axis(side = 2, at = seq(0, 1, by = .1), labels = c(0:1))
mtext('Kappa', side = 2, line = 0)
lines(klower, lty = 2, col = 'red')
lines(khigher, lty = 2, col = 'red')
plot(kavg, type = 'p', xaxt = 'n', xlim = c(0:60), yaxt = 'n')
axis(side = 1, at = seq(0,60, by = 5), labels = seq(0,60, by = 5))
mtext('Component', side = 1, line = 2)
axis(side = 2, at = seq(0, 1, by = .1), labels = seq(0, 1, by = .1))
mtext('Kappa', side = 2, line = 2)
lines(klower, lty = 2, col = 'red')
lines(khigher, lty = 2, col = 'red')
plot(kavg, type = 'p', xaxt = 'n', yaxt = 'n')
axis(side = 1, at = seq(0,60, by = 5), labels = seq(0,60, by = 5))
mtext('Component', side = 1, line = 2)
axis(side = 2, at = seq(0, 1, by = .1), labels = seq(0, 1, by = .1))
mtext('Kappa', side = 2, line = 2)
lines(klower, lty = 2, col = 'red')
lines(khigher, lty = 2, col = 'red')
?plot
plot(kavg, type = 'p', pch = 16, ylab = 'Kappa', xlab = 'Component')
lines(klower, lty = 2, col = 'red')
lines(khigher, lty = 2, col = 'red')
plot(kavg, type = 'l', lty = 1, ylab = 'Kappa', xlab = 'Component')
lines(klower, lty = 2, col = 'red')
lines(khigher, lty = 2, col = 'red')
plot(kavg, type = 'p', pch = 16, cex = .75, ylab = 'Kappa', xlab = 'Component')
lines(klower, lty = 2, col = 'red')
lines(khigher, lty = 2, col = 'red')
plot(kavg, type = 'p', pch = 16, cex = .75, ylab = 'Kappa', xlab = 'Component',
xlim = c(0:60))
lines(klower, lty = 2, col = 'red')
lines(khigher, lty = 2, col = 'red')
plot(kavg, type = 'p', pch = 16, cex = .75, ylab = 'Kappa', xlab = 'Component',
xlim = c(0,60))
lines(klower, lty = 2, col = 'red')
lines(khigher, lty = 2, col = 'red')
a4
a1 = as.matrix(plsFit1$results$Accuracy)
a2 = as.matrix(plsFit2$results$Accuracy)
a3 = as.matrix(plsFit3$results$Accuracy)
a4 = as.matrix(plsFit4$results$Accuracy)
a5 = as.matrix(plsFit5$results$Accuracy)
a6 = as.matrix(plsFit6$results$Accuracy)
a7 = as.matrix(plsFit7$results$Accuracy)
a8 = as.matrix(plsFit8$results$Accuracy)
a9 = as.matrix(plsFit9$results$Accuracy)
a10 = as.matrix(plsFit10$results$Accuracy)
a.total = Reduce(cbind, list(a1,a2,a3,a4,a5,a6,a7,a8,a9,a10))
a.avg = as.matrix(rowMeans(a.total))
a.sd = as.matrix(rowSds(a.total))
alower = a.avg - a.sd
ahigher = a.avg + a.sd
plot(a.avg, type = 'p', pch = 16, cex = .75, ylab = 'Accuracy', xlab = 'Component',
xlim = c(0,60), main = 'Accuracy for Species_ID')
lines(alower, lty = 2, col = 'red')
lines(ahigher, lty = 2, col = 'red')
plot(a.avg, type = 'p', pch = 16, cex = .75, ylab = 'Accuracy', xlab = 'Component',
xlim = c(0,30), main = 'Accuracy for Species_ID')
lines(alower, lty = 2, col = 'red')
lines(ahigher, lty = 2, col = 'red')
plot(a.avg, type = 'p', pch = 16, cex = .75, ylab = 'Accuracy', xlab = 'Component',
xlim = c(1,30), main = 'Accuracy for Species_ID')
lines(alower, lty = 2, col = 'red')
lines(ahigher, lty = 2, col = 'red')
plot(a.avg, type = 'p', pch = 16, cex = .75, ylab = 'Accuracy', xlab = 'Component',
xlim = c(1,40), main = 'Accuracy for Species_ID')
lines(alower, lty = 2, col = 'red')
lines(ahigher, lty = 2, col = 'red')
plot(kavg, type = 'p', pch = 16, cex = .75, ylab = 'Kappa', xlab = 'Component',
xlim = c(0,40), main = 'Kappa for Species_ID')
lines(klower, lty = 2, col = 'red')
lines(khigher, lty = 2, col = 'red')
plot(a.avg, type = 'p', pch = 16, cex = .75, ylab = 'Accuracy', xlab = 'Component',
xlim = c(1,40), main = 'Accuracy for Species_ID')
lines(alower, lty = 2, col = 'red')
lines(ahigher, lty = 2, col = 'red')
abline(v = 22, col = 'blue')
plot(kavg, type = 'p', pch = 16, cex = .75, ylab = 'Kappa', xlab = 'Component',
xlim = c(0,40), main = 'Kappa for Species_ID')
lines(klower, lty = 2, col = 'red')
lines(khigher, lty = 2, col = 'red')
abline(v = 22, col = 'blue')
plot(a.avg, type = 'p', pch = 16, cex = .75, ylab = 'Accuracy', xlab = 'Component',
xlim = c(1,40), main = 'Accuracy for Species_ID')
lines(alower, lty = 2, col = 'red')
lines(ahigher, lty = 2, col = 'red')
abline(v = 22, col = 'blue')
legend('bottomright', legend = c('Mean', 'Standard deviation', 'Best component'),
pch = c(16, NA, NA), lty = c(NA, 2, 1), col = c('black', 'red', 'blue'))
plot(kavg, type = 'p', pch = 16, cex = .75, ylab = 'Kappa', xlab = 'Component',
xlim = c(0,40), main = 'Kappa for Species_ID')
lines(klower, lty = 2, col = 'red')
lines(khigher, lty = 2, col = 'red')
abline(v = 22, col = 'blue')
legend('bottomright', legend = c('Mean', 'Standard deviation', 'Best component'),
pch = c(16, NA, NA), lty = c(NA, 2, 1), col = c('black', 'red', 'blue'))
