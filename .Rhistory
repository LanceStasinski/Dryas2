plot(x[,1], xaxt = 'n', type = "l", lwd = 3, col = "red", xlab = "Wavelength", ylab = "Loading Value",
panel.first = c(rect(1,-.10,31, .15, col = "gray90", border = NA),
rect(41,-.1,91, .15, col = "gray90", border = NA),
rect(116, -.1, 141, .15, col = "gray90", border = NA),
rect(161,-.1, 201, .15, col = "gray90", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,6,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = 1)
abline(h = 0, lty = 3, lwd = 2)
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(x[,1], xaxt = 'n', type = "l", lwd = 3, col = "red", xlab = "Wavelength", ylab = "Loading Value",
panel.first = c(rect(1,-.10,31, .15, col = "gray90", border = NA),
rect(41,-.1,91, .15, col = "gray90", border = NA),
rect(116, -.1, 141, .15, col = "gray90", border = NA),
rect(161,-.1, 201, .15, col = "gray90", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = 3)
abline(h = 0, lty = 3, lwd = 2)
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(x[,1], xaxt = 'n', type = "l", lwd = 3, col = "red", xlab = "Wavelength", ylab = "Loading Value",
panel.first = c(rect(1,-.10,31, .15, col = "gray90", border = NA),
rect(41,-.1,91, .15, col = "gray90", border = NA),
rect(116, -.1, 141, .15, col = "gray90", border = NA),
rect(161,-.1, 201, .15, col = "gray90", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = 0)
abline(h = 0, lty = 3, lwd = 2)
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(x[,1], xaxt = 'n', type = "l", lwd = 3, col = "red", xlab = "Wavelength", ylab = "Loading Value",
panel.first = c(rect(1,-.10,31, .15, col = "gray90", border = NA),
rect(41,-.1,91, .15, col = "gray90", border = NA),
rect(116, -.1, 141, .15, col = "gray90", border = NA),
rect(161,-.1, 201, .15, col = "gray90", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
abline(h = 0, lty = 3, lwd = 2)
?plot
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(x[,1], main = "PLSDA Loadings for Species", xaxt = 'n', type = "l", lwd = 3, col = "red", xlab = "Wavelength", ylab = "Loading Value",
panel.first = c(rect(1,-.10,31, .15, col = "gray90", border = NA),
rect(41,-.1,91, .15, col = "gray90", border = NA),
rect(116, -.1, 141, .15, col = "gray90", border = NA),
rect(161,-.1, 201, .15, col = "gray90", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
abline(h = 0, lty = 3, lwd = 2)
Comp1 = x[,1]
Comp2 = x[,2]
Comp3 = x[,3]
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species", xaxt = 'n', type = "l", lwd = 3,
col = "red", xlab = "Wavelength", ylab = "Loading Value",
panel.first = c(rect(1,-.10,31, .15, col = "gray90", border = NA),
rect(41,-.1,91, .15, col = "gray90", border = NA),
rect(116, -.1, 141, .15, col = "gray90", border = NA),
rect(161,-.1, 201, .15, col = "gray90", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
abline(h = 0, lty = 2, lwd = 2)
plot(Comp2, xaxt='n', type='l', lwd = 3, col = "blue", add = TRUE)
x = plsda.fit$loadings$X
Comp1 = x[,1]
Comp2 = x[,2]
Comp3 = x[,3]
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species", xaxt = 'n', type = "l", lwd = 3,
col = "red", xlab = "Wavelength", ylab = "Loading Value",
panel.first = c(rect(1,-.10,31, .15, col = "gray90", border = NA),
rect(41,-.1,91, .15, col = "gray90", border = NA),
rect(116, -.1, 141, .15, col = "gray90", border = NA),
rect(161,-.1, 201, .15, col = "gray90", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
abline(h = 0, lty = 2, lwd = 2)
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species", xaxt = 'n', type = "l", lwd = 3,
col = "red", xlab = "Wavelength", ylab = "Loading Value", ylim = c(-0.20, 0.20)
panel.first = c(rect(1,-.10,31, .15, col = "gray90", border = NA),
rect(41,-.1,91, .15, col = "gray90", border = NA),
rect(116, -.1, 141, .15, col = "gray90", border = NA),
rect(161,-.1, 201, .15, col = "gray90", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
abline(h = 0, lty = 2, lwd = 2)
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species", xaxt = 'n', type = "l", lwd = 3,
col = "red", xlab = "Wavelength", ylab = "Loading Value", ylim = c(-0.20, 0.20),
panel.first = c(rect(1,-.10,31, .15, col = "gray90", border = NA),
rect(41,-.1,91, .15, col = "gray90", border = NA),
rect(116, -.1, 141, .15, col = "gray90", border = NA),
rect(161,-.1, 201, .15, col = "gray90", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
abline(h = 0, lty = 2, lwd = 2)
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species", xaxt = 'n', type = "l", lwd = 3,
col = "red", xlab = "Wavelength", ylab = "Loading Value", ylim = c(-0.20, 0.20),
panel.first = c(rect(1,-.10,31, .15, col = "gray90", border = NA),
rect(41,-.1,91, .15, col = "gray90", border = NA),
rect(116, -.1, 141, .15, col = "gray90", border = NA),
rect(161,-.1, 201, .15, col = "gray90", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
lines(Comp2, col="blue",lty=1)
abline(h = 0, lty = 2, lwd = 2)
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species", xaxt = 'n', type = "l", lwd = 3,
col = "red", xlab = "Wavelength", ylab = "Loading Value", ylim = c(-0.20, 0.20),
panel.first = c(rect(1,-.10,31, .15, col = "gray90", border = NA),
rect(41,-.1,91, .15, col = "gray90", border = NA),
rect(116, -.1, 141, .15, col = "gray90", border = NA),
rect(161,-.1, 201, .15, col = "gray90", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
lines(Comp2, col="blue",lty=1, lwd = 3)
lines(Comp3, col="yellow", lty = 1, lwd = 3)
abline(h = 0, lty = 2, lwd = 2)
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species", xaxt = 'n', type = "l", lwd = 3,
col = "red", xlab = "Wavelength", ylab = "Loading Value", ylim = c(-0.25, 0.20),
panel.first = c(rect(1,-.10,31, .15, col = "gray90", border = NA),
rect(41,-.1,91, .15, col = "gray90", border = NA),
rect(116, -.1, 141, .15, col = "gray90", border = NA),
rect(161,-.1, 201, .15, col = "gray90", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
lines(Comp2, col="blue",lty=1, lwd = 3)
lines(Comp3, col="yellow", lty = 1, lwd = 3)
abline(h = 0, lty = 2, lwd = 2)
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species", xaxt = 'n', type = "l", lwd = 3,
col = "red", xlab = "Wavelength", ylab = "Loading Value", ylim = c(-0.25, 0.20),
panel.first = c(rect(1,-.25,31, .2, col = "gray90", border = NA),
rect(41,-.25,91, .2, col = "gray90", border = NA),
rect(116, -.25, 141, .2, col = "gray90", border = NA),
rect(161,-.25, 201, .2, col = "gray90", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
lines(Comp2, col="blue",lty=1, lwd = 3)
lines(Comp3, col="yellow", lty = 1, lwd = 3)
abline(h = 0, lty = 2, lwd = 2)
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species", xaxt = 'n', type = "l", lwd = 3,
col = "red", xlab = "Wavelength", ylab = "Loading Value", ylim = c(-0.25, 0.20),
panel.first = c(rect(1,-.3,31, .25, col = "gray90", border = NA),
rect(41,-.3,91, .25, col = "gray90", border = NA),
rect(116, -.3, 141, .25, col = "gray90", border = NA),
rect(161,-.3, 201, .25, col = "gray90", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
lines(Comp2, col="blue",lty=1, lwd = 3)
lines(Comp3, col="yellow", lty = 1, lwd = 3)
abline(h = 0, lty = 2, lwd = 2)
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species", xaxt = 'n', type = "l", lwd = 3,
col = "red4", xlab = "Wavelength", ylab = "Loading Value", ylim = c(-0.25, 0.20),
panel.first = c(rect(1,-.3,31, .25, col = "gray90", border = NA),
rect(41,-.3,91, .25, col = "gray90", border = NA),
rect(116, -.3, 141, .25, col = "gray90", border = NA),
rect(161,-.3, 201, .25, col = "gray90", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
lines(Comp2, col="royalblue2",lty=1, lwd = 3)
lines(Comp3, col="seagrean", lty = 1, lwd = 3)
abline(h = 0, lty = 2, lwd = 2)
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species", xaxt = 'n', type = "l", lwd = 3,
col = "red4", xlab = "Wavelength", ylab = "Loading Value", ylim = c(-0.25, 0.20),
panel.first = c(rect(1,-.3,31, .25, col = "gray90", border = NA),
rect(41,-.3,91, .25, col = "gray90", border = NA),
rect(116, -.3, 141, .25, col = "gray90", border = NA),
rect(161,-.3, 201, .25, col = "gray90", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
lines(Comp2, col="royalblue2",lty=1, lwd = 3)
lines(Comp3, col="seagreen", lty = 1, lwd = 3)
abline(h = 0, lty = 2, lwd = 2)
x = plsda.fit$loadings$X
Comp1 = x[,1]
Comp2 = x[,2]
Comp3 = x[,3]
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species", xaxt = 'n', type = "l", lwd = 3,
col = "red", xlab = "Wavelength", ylab = "Loading Value", ylim = c(-0.25, 0.20),
panel.first = c(rect(1,-.3,31, .25, col = "gray90", border = NA),
rect(41,-.3,91, .25, col = "gray90", border = NA),
rect(116, -.3, 141, .25, col = "gray90", border = NA),
rect(161,-.3, 201, .25, col = "gray90", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
lines(Comp2, col="blue",lty=1, lwd = 3)
lines(Comp3, col="green", lty = 1, lwd = 3)
abline(h = 0, lty = 2, lwd = 2)
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species", xaxt = 'n', type = "l", lwd = 3,
col = "red", xlab = "Wavelength", ylab = "Loading Value", ylim = c(-0.25, 0.20),
panel.first = c(rect(1,-.3,31, .25, col = "gray90", border = NA),
rect(41,-.3,91, .25, col = "gray90", border = NA),
rect(116, -.3, 141, .25, col = "gray90", border = NA),
rect(161,-.3, 201, .25, col = "gray90", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
lines(Comp2, col="blue",lty=1, lwd = 3)
lines(Comp3, col="green4", lty = 1, lwd = 3)
abline(h = 0, lty = 2, lwd = 2)
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species", xaxt = 'n', type = "l", lwd = 3,
col = "red", xlab = "Wavelength", ylab = "Loading Value", ylim = c(-0.25, 0.20),
panel.first = c(rect(1,-.3,31, .25, col = "gray90", border = NA),
rect(41,-.3,91, .25, col = "gray90", border = NA),
rect(116, -.3, 141, .25, col = "gray90", border = NA),
rect(161,-.3, 201, .25, col = "gray90", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
lines(Comp2, col="blue",lty=1, lwd = 3)
lines(Comp3, col="green3", lty = 1, lwd = 3)
abline(h = 0, lty = 2, lwd = 2)
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species", xaxt = 'n', type = "l", lwd = 3,
col = "red", xlab = "Wavelength", ylab = "Loading Value", ylim = c(-0.25, 0.20),
panel.first = c(rect(1,-.3,31, .25, col = "gray90", border = NA),
rect(41,-.3,91, .25, col = "gray90", border = NA),
rect(116, -.3, 141, .25, col = "gray90", border = NA),
rect(161,-.3, 201, .25, col = "gray90", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
lines(Comp2, col="blue",lty=1, lwd = 3)
lines(Comp3, col="green3", lty = 1, lwd = 3)
abline(h = 0, lty = 2, lwd = 2)
legend("bottomright", inset=.02, title="Components",
c("1","2","3"), fill=topo.colors(3), horiz=TRUE, cex=0.8)
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species", xaxt = 'n', type = "l", lwd = 3,
col = "red", xlab = "Wavelength", ylab = "Loading Value", ylim = c(-0.25, 0.20),
panel.first = c(rect(1,-.3,31, .25, col = "gray90", border = NA),
rect(41,-.3,91, .25, col = "gray90", border = NA),
rect(116, -.3, 141, .25, col = "gray90", border = NA),
rect(161,-.3, 201, .25, col = "gray90", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
lines(Comp2, col="blue",lty=1, lwd = 3)
lines(Comp3, col="green3", lty = 1, lwd = 3)
abline(h = 0, lty = 2, lwd = 2)
legend("bottomright", inset=.02, title="Components",
c("1","2","3"), fill=topo.colors(4), horiz=TRUE, cex=0.8)
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species", xaxt = 'n', type = "l", lwd = 3,
col = "red", xlab = "Wavelength", ylab = "Loading Value", ylim = c(-0.25, 0.20),
panel.first = c(rect(1,-.3,31, .25, col = "gray90", border = NA),
rect(41,-.3,91, .25, col = "gray90", border = NA),
rect(116, -.3, 141, .25, col = "gray90", border = NA),
rect(161,-.3, 201, .25, col = "gray90", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
lines(Comp2, col="blue",lty=1, lwd = 3)
lines(Comp3, col="green3", lty = 1, lwd = 3)
abline(h = 0, lty = 2, lwd = 2)
legend("bottomright", inset=.02, title="Components",
c("1","2","3"), fill= c("red", "blue", "green3"), horiz=TRUE, cex=0.8)
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species", xaxt = 'n', type = "l", lwd = 3,
col = "red", xlab = "Wavelength", ylab = "Loading Value", ylim = c(-0.25, 0.20),
panel.first = c(rect(1,-.3,31, .25, col = "gray90", border = NA),
rect(41,-.3,91, .25, col = "gray90", border = NA),
rect(116, -.3, 141, .25, col = "gray90", border = NA),
rect(161,-.3, 201, .25, col = "gray90", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
lines(Comp2, col="blue",lty=1, lwd = 3)
lines(Comp3, col="green", lty = 1, lwd = 3)
abline(h = 0, lty = 2, lwd = 2)
legend("bottomright", inset=.02, title="Components",
c("1","2","3"), fill= c("red", "blue", "green"), horiz=TRUE, cex=0.8)
plsda.fit$explained_variance
Comp3
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species", xaxt = 'n', type = "l", lwd = 3,
col = "red", xlab = "Wavelength", ylab = "Loading Value", ylim = c(-0.25, 0.20),
panel.first = c(rect(1,-.3,31, .25, col = "gray95", border = NA),
rect(41,-.3,91, .25, col = "gray95", border = NA),
rect(116, -.3, 141, .25, col = "gray95", border = NA),
rect(161,-.3, 201, .25, col = "gray95", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
lines(Comp2, col="blue",lty=1, lwd = 3)
lines(Comp3, col="green", lty = 1, lwd = 3)
abline(h = 0, lty = 2, lwd = 2)
legend("bottomright", inset=.02, title="Components",
c("1","2","3"), fill= c("red", "blue", "green"), horiz=TRUE, cex=0.8)
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species - Dry, No Hybrids", xaxt = 'n', type = "l", lwd = 3,
col = "red", xlab = "Wavelength", ylab = "Loading Value", ylim = c(-0.25, 0.20),
panel.first = c(rect(1,-.3,31, .25, col = "gray95", border = NA),
rect(41,-.3,91, .25, col = "gray95", border = NA),
rect(116, -.3, 141, .25, col = "gray95", border = NA),
rect(161,-.3, 201, .25, col = "gray95", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
lines(Comp2, col="blue",lty=1, lwd = 3)
lines(Comp3, col="green", lty = 1, lwd = 3)
abline(h = 0, lty = 2, lwd = 2)
legend("bottomright", inset=.02, title="Components",
c("1","2","3"), fill= c("red", "blue", "green"), horiz=TRUE, cex=0.8)
install.packages("grDevices")
install.packages("grDevices")
install.packages("grDevices")
install.packages("grDevices")
library(grDevices)
pal = colorRamp(c("red", "blue"))
x = plsda.fit$loadings$X
Comp1 = x[,1]
Comp2 = x[,2]
Comp3 = x[,3]
pal = colorRamp(c("red", "blue"))
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species - Dry, No Hybrids", xaxt = 'n', type = "l", lwd = 3,
col = pal(.9), xlab = "Wavelength", ylab = "Loading Value", ylim = c(-0.25, 0.20),
panel.first = c(rect(1,-.3,31, .25, col = "gray95", border = NA),
rect(41,-.3,91, .25, col = "gray95", border = NA),
rect(116, -.3, 141, .25, col = "gray95", border = NA),
rect(161,-.3, 201, .25, col = "gray95", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
lines(Comp2, col= pal(.1),lty=1, lwd = 3)
lines(Comp3, col= pal(.5), lty = 1, lwd = 3)
abline(h = 0, lty = 2, lwd = 2)
legend("bottomright", inset=.02, title="Components",
c("1","2","3"), fill= pal(c(.9,.1,.5)), horiz=TRUE, cex=0.8)
x = plsda.fit$loadings$X
Comp1 = x[,1]
Comp2 = x[,2]
Comp3 = x[,3]
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species - Dry, No Hybrids", xaxt = 'n', type = "l", lwd = 3,
col = "red", xlab = "Wavelength", ylab = "Loading Value", ylim = c(-0.25, 0.20),
panel.first = c(rect(1,-.3,31, .25, col = "gray95", border = NA),
rect(41,-.3,91, .25, col = "gray95", border = NA),
rect(116, -.3, 141, .25, col = "gray95", border = NA),
rect(161,-.3, 201, .25, col = "gray95", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
lines(Comp2, col="blue",lty=1, lwd = 3)
lines(Comp3, col="green", lty = 1, lwd = 3)
abline(h = 0, lty = 2, lwd = 2)
legend("bottomright", inset=.02, title="Components",
c("1","2","3"), fill= c("red", "blue", "green"), horiz=TRUE, cex=0.8)
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species - Dry, No Hybrids", xaxt = 'n', type = "l", lwd = 3,
col = "red", xlab = "Wavelength", ylab = "Loading Value", ylim = c(-0.25, 0.20),
panel.first = c(rect(1,-.3,31, .25, col = "gray95", border = NA),
rect(41,-.3,91, .25, col = "gray95", border = NA),
rect(116, -.3, 141, .25, col = "gray95", border = NA),
rect(161,-.3, 201, .25, col = "gray95", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
lines(Comp2, col="blue",lty=1, lwd = 3)
lines(Comp3, col="orange", lty = 1, lwd = 3)
abline(h = 0, lty = 2, lwd = 2)
legend("bottomright", inset=.02, title="Components",
c("1","2","3"), fill= c("red", "blue", "orange"), horiz=TRUE, cex=0.8)
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species - Dry, No Hybrids", xaxt = 'n', type = "l", lwd = 3,
col = "red", xlab = "Wavelength", ylab = "Loading Value", ylim = c(-0.25, 0.20),
panel.first = c(rect(1,-.3,31, .25, col = "gray95", border = NA),
rect(41,-.3,91, .25, col = "gray95", border = NA),
rect(116, -.3, 141, .25, col = "gray95", border = NA),
rect(161,-.3, 201, .25, col = "gray95", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
lines(Comp2, col="blue",lty=1, lwd = 3)
lines(Comp3, col="purple", lty = 1, lwd = 3)
abline(h = 0, lty = 2, lwd = 2)
legend("bottomright", inset=.02, title="Components",
c("1","2","3"), fill= c("red", "blue", "orange"), horiz=TRUE, cex=0.8)
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species - Dry, No Hybrids", xaxt = 'n', type = "l", lwd = 3,
col = "red", xlab = "Wavelength", ylab = "Loading Value", ylim = c(-0.25, 0.20),
panel.first = c(rect(1,-.3,31, .25, col = "gray95", border = NA),
rect(41,-.3,91, .25, col = "gray95", border = NA),
rect(116, -.3, 141, .25, col = "gray95", border = NA),
rect(161,-.3, 201, .25, col = "gray95", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
lines(Comp2, col="turquoise1",lty=1, lwd = 3)
lines(Comp3, col="purple", lty = 1, lwd = 3)
abline(h = 0, lty = 2, lwd = 2)
legend("bottomright", inset=.02, title="Components",
c("1","2","3"), fill= c("red", "blue", "orange"), horiz=TRUE, cex=0.8)
x = plsda.fit$loadings$X
Comp1 = x[,1]
Comp2 = x[,2]
Comp3 = x[,3]
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species - Dry, No Hybrids", xaxt = 'n', type = "l", lwd = 3,
col = "red", xlab = "Wavelength", ylab = "Loading Value", ylim = c(-0.25, 0.20),
panel.first = c(rect(1,-.3,31, .25, col = "gray95", border = NA),
rect(41,-.3,91, .25, col = "gray95", border = NA),
rect(116, -.3, 141, .25, col = "gray95", border = NA),
rect(161,-.3, 201, .25, col = "gray95", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
lines(Comp2, col="turquoise1",lty=1, lwd = 3)
lines(Comp3, col="purple", lty = 1, lwd = 3)
abline(h = 0, lty = 2, lwd = 2)
legend("bottomright", inset=.02, title="Components",
c("1","2","3"), fill= c("red", "turquoise1", "purple"), horiz=TRUE, cex=0.8)
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species - Dry, No Hybrids", xaxt = 'n', type = "l", lwd = 3,
col = "red", xlab = "Wavelength", ylab = "Loading Value", ylim = c(-0.25, 0.20),
panel.first = c(rect(1,-.3,31, .25, col = "gray95", border = NA),
rect(41,-.3,91, .25, col = "gray95", border = NA),
rect(116, -.3, 141, .25, col = "gray95", border = NA),
rect(161,-.3, 201, .25, col = "gray95", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
lines(Comp2, col="turquoise2",lty=1, lwd = 3)
lines(Comp3, col="purple", lty = 1, lwd = 3)
abline(h = 0, lty = 2, lwd = 2)
legend("bottomright", inset=.02, title="Components",
c("1","2","3"), fill= c("red", "turquoise1", "purple"), horiz=TRUE, cex=0.8)
par(mar = c(5,5,5,1), mgp = c(3, 1, 0))
plot(Comp1, main = "PLSDA Loadings for Species - Dry, No Hybrids", xaxt = 'n', type = "l", lwd = 3,
col = "red", xlab = "Wavelength", ylab = "Loading Value", ylim = c(-0.25, 0.20),
panel.first = c(rect(1,-.3,31, .25, col = "gray95", border = NA),
rect(41,-.3,91, .25, col = "gray95", border = NA),
rect(116, -.3, 141, .25, col = "gray95", border = NA),
rect(161,-.3, 201, .25, col = "gray95", border = NA)))
axis(1, at=c(11, 61, 111, 161), labels=rownames(x)[c(11, 61, 111, 161)])
axis(3, at=c(16,66,128.5,181), tick = FALSE, labels = c("VIS", "NIR", "SWIR 1", "SWIR 2"),
line = -1)
lines(Comp2, col="turquoise2",lty=1, lwd = 3)
lines(Comp3, col="purple", lty = 1, lwd = 3)
abline(h = 0, lty = 2, lwd = 2)
legend("bottomright", inset=.02, title="Components",
c("1","2","3"), fill= c("red", "turquoise2", "purple"), horiz=TRUE, cex=0.8)
plsda.fit$explained_variance
spec_all1 = readRDS("Clean-up/Vector_normalized/all_vn.rds")
spec_all = spec_all1[!meta(spec_all1)$Species_ID == "DX",]
names(spec_all) = meta(spec_all)$Species_ID
spec_all.m = as.matrix(spec_all)
spec_all.df = as.data.frame(spec_all)
#Resample by every 10 nm
spec_small = resample(spec_all, seq(400, 2400, by = 10))
spec_mat_s = as.matrix(spec_small)
spec_mat = spec_mat_s
resp = rownames(spec_mat)
rownames(spec_mat) = seq(nrow(spec_mat))
#determine number of components to use
plsda.fit = plsda(spec_mat, resp, ncomp = 30)
library(mixOmics)
library(spectrolab)
library(plotrix)
library(rgl)
library(grDevices)
spec_all1 = readRDS("Clean-up/Vector_normalized/all_vn.rds")
spec_all = spec_all1[!meta(spec_all1)$Species_ID == "DX",]
names(spec_all) = meta(spec_all)$Species_ID
spec_all.m = as.matrix(spec_all)
spec_all.df = as.data.frame(spec_all)
#Resample by every 10 nm
spec_small = resample(spec_all, seq(400, 2400, by = 10))
spec_mat_s = as.matrix(spec_small)
spec_mat = spec_mat_s
resp = rownames(spec_mat)
rownames(spec_mat) = seq(nrow(spec_mat))
#determine number of components to use
plsda.fit = plsda(spec_mat, resp, ncomp = 30)
set.seed(25)
samp <- sample(1:3, nrow(spec_mat), replace = TRUE)
# 1/3 of the data will compose the test set
test <- which(samp == 1)
# rest will compose the training set
train <- setdiff(1:nrow(spec_mat), test)
## For PLS-DA, train the model
plsda.train <- plsda(spec_mat[train, ], resp[train], ncomp = 21)
# then predict
test.predict <- predict(plsda.train, spec_mat[test, ], dist = "max.dist")
# store prediction for the 4th component
prediction <- test.predict$class$max.dist[,21]
prediction
test.predict$predict
